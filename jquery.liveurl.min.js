!function(a){a.fn.extend({liveUrl:function(b){var c={meta:[["description","name","description"],["description","property","og:description"],["description","property","pinterestapp:about"],["image","property","og:image"],["image","itemprop","image"],["title","name","title"],["title","property","og:title"],["video","property","og:video"],["video_type","property","og:video:type"],["video_width","property","og:video:width"],["video_height","property","og:video:height"]],findLogo:!1,findDescription:!0,matchNoData:!0,multipleImages:!0,defaultProtocol:"http://",minWidth:100,minHeight:32,logoWord:"logo",adapter:"opengraphio",success:function(){},loadStart:function(){},loadEnd:function(){},imgLoadStart:function(){},imgLoadEnd:function(){},addImage:function(){}},b=a.extend(c,b);this.each(function(){var c=b,d={already:[]},e={};d.init=function(){d.preview=!1,d.processedImg=0,e={url:"",images:[],image:"",title:"",description:""}},d.textUpdate=function(b){var c=a.urlHelper.getLinks(a(b).val());d.cleanDuplicates(c),null!=c&&(d.preview||(d.current=a(b),d.process(c)))},d.process=function(f){for(var g in f){var h=f[g];if("string"==typeof h){var i=new a.urlHelper.UriParser(h);if((i.subdomain&&i.subdomain.length>0||i.protocol&&i.protocol.length>0)&&(0==i.protocol.length&&(h=c.defaultProtocol+h),!d.isDuplicate(h,d.already)))return a.urlHelper.isImage(h)?(e.image=h,d.getPreview({},h)):d.getData(h,b.adapter),!0}}},d.cleanDuplicates=function(b){var c=d.createLinks(b);for(var e in d.already){var f=d.already[e];if(!d.isDuplicate(f,c)){var e=a.inArray(f,d.already);d.already.splice(e,1)}}},d.createLinks=function(b){var d=[];for(var e in b){var f=b[e];if("string"==typeof f){var g=new a.urlHelper.UriParser(f);(g.subdomain&&g.subdomain.length>0||g.protocol&&g.protocol.length>0)&&(0==g.protocol.length&&(f=c.defaultProtocol+f),d.push(f))}}return d},d.isDuplicate=function(b,c){var d=!1;return a.each(c,function(a,c){c==b&&(d=!0)}),d},d.getData=function(b,c){if(c=c?c:"yql",d.addLoader(),"yql"==c){var e="//head|//body",f='select * from html where url="'+b+'" and compat="html5" and xpath="'+e+'"';a.yql(f,function(){var a={query:{results:null}};return d.ajaxSuccess(a,b),d.removeLoader(),!1},function(a){d.ajaxSuccess(a,b)})}"opengraphio"==c&&a.ajax({url:"https://opengraph.io/api/1.0/site/"+encodeURIComponent(b),success:function(a){d.getPreviewFromOpengraphio(a,b)},error:function(a){console.log("error")}})},d.ajaxSuccess=function(b,e,f){return d.isDuplicate(e,d.already)||d.preview?(d.removeLoader(),!1):void(0==a(b).find("results").text().length?c.matchNoData?d.getPreview(b,e):(d.already.push(e),d.removeLoader()):d.getPreview(b,e))},d.hasValue=function(a){return 0!=e[a].length},d.getPreviewFromOpengraphio=function(a,b){d.preview=!0,d.already.push(b),e.title=a.hybridGraph.title,e.url=b,e.description=a.hybridGraph.description,e.image=a.hybridGraph.image,d.removeLoader();var f="undefined",a={title:e.title,description:e.description,url:e.url,video:typeof e.video!=f&&e.video.length>0?{}:null};c.success(a),d.hasValue("image")&&(e.images.push(e.image),e.image=""),d.addImages(),d.current.one("clear",function(){d.init()})},d.getPreview=function(b,f){d.preview=!0,d.already.push(f);var g="";if(a(b,"<head>").find("title").each(function(){g=a(this).text()}),e.title=g||f,e.url=f,a(b,"<head>").find("meta").each(function(){d.setMetaData(a(this))}),c.findDescription&&!d.hasValue("description")&&a(b,"<body>").find("p").each(function(){var b=a.trim(a(this).text());if(b.length>3)return e.description=b,!1}),!d.hasValue("image")){var h=a(b,"<body>").find("img");c.findLogo&&h.each(function(){var b=a(this);if(b.attr("src")&&b.attr("src").search(c.logoWord,"i")!=-1||b.attr("id")&&b.attr("id").search(c.logoWord,"i")!=-1||this.className&&this.className.search(c.logoWord,"i")!=-1)return e.image=a(this).attr("src"),!1}),!d.hasValue("image")&&h.length>0&&h.each(function(){e.images.push(a(this).attr("src"))})}d.removeLoader();var i="undefined",b={title:e.title,description:e.description,url:e.url,video:typeof e.video!=i&&e.video.length>0?{}:null};null!=b.video&&(b.video={file:e.video,type:typeof e.video_type!=i?e.video_type:"",width:typeof e.video_width!=i?e.video_width:"",height:typeof e.video_height!=i?e.video_height:""}),c.success(b),d.hasValue("image")&&(e.images.push(e.image),e.image=""),d.addImages(),d.current.one("clear",function(){d.init()})},d.addLoader=function(){c.loadStart()},d.removeLoader=function(){c.loadEnd()},d.setMetaData=function(a){for(index in c.meta){var b=c.meta[index];e[b[0]]=d.getValue(a,b[1],b[2])||e[b[0]]}},d.getValue=function(a,b,c){if(a.attr(b)&&a.attr(b).toLowerCase()==c.toLowerCase()&&a.attr("content")&&a.attr("content").length>0)return a.attr("content")},d.addImages=function(){for(var b in e.images){var f=e.images[b];if(!a.urlHelper.isAbsolute(f)){var g=new a.urlHelper.UriParser(e.url),h=g.url+g.subdomain+g.domain;f=a.urlHelper.isPathAbsolute(f)?h+f:h+a.urlHelper.stripFile(g.path)+"/"+f}d.getImage(f,function(a){a.width>=c.minWidth&&a.height>=c.minHeight&&d.preview&&(c.addImage(a),!c.multipleImages)})}},d.getImage=function(b,f){var g=a.urlHelper.hasParam(b)?"&":"?";b+=g+"random="+(new Date).getTime(),a("<img />").attr({src:b}).load(function(){var a=this,b=window.setInterval(function(){d.processedImg++,a.width&&(window.clearInterval(b),f(a)),d.processedImg==e.images.length&&c.imgLoadEnd()},100)})},d.init();var f=this,g=a(this);g.on("keyup",function(b){var c=a.urlHelper.getLinks(a(g).val());d.cleanDuplicates(c),window.clearInterval(d.textTimer);var e=b.keyCode?b.keyCode:b.which;13==e||32==e?d.textUpdate(f):d.textTimer=window.setInterval(function(){d.textUpdate(f),window.clearInterval(d.textTimer)},1e3)}).on("paste",function(){d.textUpdate(f)})})}}),jQuery.yql=function b(c,d,e){var b={path:"https://query.yahooapis.com/v1/public/yql?q=",query:encodeURIComponent(c)};a.ajax({crossDomain:!0,cache:!1,type:"GET",url:b.path+b.query,timeout:8e3,dataType:"xml",error:d,success:e})},jQuery.urlHelper={UriParser:function(a){this._regExp=/^((\w+):\/\/\/?)?((\w+):?(\w+)?@)?([^\/\?:]+)?(:\d+)?(.*)?/,this._regExpHost=/^(.+\.)?(.+\..+)$/,this._getVal=function(a,b){return a?"undefined"==typeof a[b]?"":a[b]:null},this.parse=function(a){var b=this._regExp.exec(a);this.results=b,this.url=this._getVal(b,1),this.protocol=this._getVal(b,2),this.username=this._getVal(b,4),this.password=this._getVal(b,5),this.domain=this._getVal(b,6),this.port=this._getVal(b,7),this.path=this._getVal(b,8);var c=this._regExpHost.exec(this.domain);return this.subdomain=this._getVal(c,1),this.domain=this._getVal(c,2),b},a&&this.parse(a)},getLinks:function(a){var b=/((https?:\/\/)?[\w-]+(\.[\w-]+)+\.?(:\d+)?(\/\S*)?)/gi;return a.match(b)},isImage:function(a,b){null==b&&(b="jpg|gif|png|jpeg");var c=/([^\s]+(?=\.(jpg|gif|png|jpeg))\.\2)/gm;return a.match(c)},isAbsolute:function(a){var b=/^(https?:)?\/\//i,c=null!=a.match(b);return c},isPathAbsolute:function(a){if("/"==a.substr(0,1))return!0},hasParam:function(a){return a.lastIndexOf("?")!=-1},stripFile:function(a){return a.substr(0,a.lastIndexOf("/")+1)}}}(jQuery);